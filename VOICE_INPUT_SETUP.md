# Voice Input Setup Instructions

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ Supabase Edge Function `whisper-proxy` –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∞—É–¥–∏–æ —á–µ—Ä–µ–∑ OpenAI Whisper API
2. ‚úÖ –°–æ–∑–¥–∞–Ω `SpeechRecognitionService.swift` –¥–ª—è –∑–∞–ø–∏—Å–∏ –∞—É–¥–∏–æ
3. ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω UI `AIChatView.swift` —Å –∫–Ω–æ–ø–∫–æ–π –∑–∞–ø–∏—Å–∏ –≥–æ–ª–æ—Å–∞

---

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—Ä—É—á–Ω—É—é:

### 1. –î–æ–±–∞–≤–∏—Ç—å permissions –≤ Info.plist

–í Xcode:

1. –û—Ç–∫—Ä–æ–π –ø—Ä–æ–µ–∫—Ç `atlas.xcodeproj`
2. –í—ã–±–µ—Ä–∏ target `atlas` –≤ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
3. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Info**
4. –ù–∞–π–¥–∏ —Å–µ–∫—Ü–∏—é **Custom iOS Target Properties** (–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ **Info**)
5. –ù–∞–∂–º–∏ –Ω–∞ `+` —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ
6. –î–æ–±–∞–≤—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–∏:

**Privacy - Microphone Usage Description**
```
Key: NSMicrophoneUsageDescription
Type: String
Value: We need access to your microphone to record voice messages for AI chat.
```

**–°–∫—Ä–∏–Ω—à–æ—Ç –¥–ª—è –ø–æ–º–æ—â–∏:**
```
[+] Information Property List
    [>] Privacy - Microphone Usage Description (NSMicrophoneUsageDescription)
        Value: We need access to your microphone to record voice messages for AI chat.
```

---

### 2. Deploy Supabase Edge Function

–í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ, –Ω–∞—Ö–æ–¥—è—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
# 1. –ó–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –≤ Supabase CLI (–µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω)
supabase login

# 2. Link –ø—Ä–æ–µ–∫—Ç (–µ—Å–ª–∏ –µ—â—ë –Ω–µ linked)
supabase link --project-ref sqchwnbwcnqegwtffxbz

# 3. Deploy –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ whisper-proxy
supabase functions deploy whisper-proxy

# 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å OpenAI API key –∫–∞–∫ —Å–µ–∫—Ä–µ—Ç
supabase secrets set OPENAI_API_KEY=your-openai-api-key-here
```

**–ì–¥–µ –≤–∑—è—Ç—å OpenAI API –∫–ª—é—á:**
1. –ó–∞–π–¥–∏ –Ω–∞ https://platform.openai.com/api-keys
2. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π API –∫–ª—é—á
3. –°–∫–æ–ø–∏—Ä—É–π –∏ –∏—Å–ø–æ–ª—å–∑—É–π –≤ –∫–æ–º–∞–Ω–¥–µ –≤—ã—à–µ

---

### 3. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª –≤ Xcode

–ù–æ–≤—ã–π —Ñ–∞–π–ª `SpeechRecognitionService.swift` –±—ã–ª —Å–æ–∑–¥–∞–Ω, –Ω–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –µ–≥–æ –≤ Xcode –ø—Ä–æ–µ–∫—Ç:

1. –í Xcode, –æ—Ç–∫—Ä–æ–π –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä —Ñ–∞–π–ª–æ–≤ (–ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å)
2. –ù–∞–π–¥–∏ –ø–∞–ø–∫—É `Services`
3. –ö–ª–∏–∫–Ω–∏ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π –Ω–∞ –ø–∞–ø–∫—É `Services`
4. –í—ã–±–µ—Ä–∏ **Add Files to "atlas"...**
5. –ù–∞–π–¥–∏ —Ñ–∞–π–ª `/Users/admin/Documents/Atlas App/atlas/Services/SpeechRecognitionService.swift`
6. –£–±–µ–¥–∏—Å—å —á—Ç–æ —á–µ–∫–±–æ–∫—Å **Copy items if needed** –≤–∫–ª—é—á—ë–Ω
7. –£–±–µ–¥–∏—Å—å —á—Ç–æ target `atlas` –≤—ã–±—Ä–∞–Ω
8. –ù–∞–∂–º–∏ **Add**

---

### 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

‚ö†Ô∏è **–í–ê–ñ–ù–û:** Voice input –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ! –ù—É–∂–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–µ iOS —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**

1. –ü–æ–¥–∫–ª—é—á–∏ iPhone/iPad —á–µ—Ä–µ–∑ USB
2. –í Xcode, –≤—ã–±–µ—Ä–∏ —Å–≤–æ—ë —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Å–ø–∏—Å–∫–µ destinations
3. Build & Run (‚åò + R)
4. –û—Ç–∫—Ä–æ–π AI Chat
5. –ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É üé§ (–º–∏–∫—Ä–æ—Ñ–æ–Ω)
6. iOS –ø–æ–ø—Ä–æ—Å–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω - —Ä–∞–∑—Ä–µ—à–∏
7. –ì–æ–≤–æ—Ä–∏ —á—Ç–æ-—Ç–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä: "Help me get a green card")
8. –ù–∞–∂–º–∏ ‚èπÔ∏è (stop) –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—à—å
9. –î–æ–∂–¥–∏—Å—å "Transcribing audio..." (2-5 —Å–µ–∫—É–Ω–¥)
10. –¢–µ–∫—Å—Ç –ø–æ—è–≤–∏—Ç—Å—è –≤ TextField
11. –ù–∞–∂–º–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

---

## üé® UI Features

### Recording UI
- ‚è∫Ô∏è –ö—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏
- üåä –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è waveform (5 –ø–æ–ª–æ—Å)
- ‚è±Ô∏è –¢–∞–π–º–µ—Ä –∑–∞–ø–∏—Å–∏ (0:00 —Ñ–æ—Ä–º–∞—Ç)
- "Recording..." –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

### Transcribing UI
- üîÑ –ü—Ä–æ–≥—Ä–µ—Å—Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
- "Transcribing audio..." —Ç–µ–∫—Å—Ç
- –ì–æ–ª—É–±–æ–π —Ñ–æ–Ω

### Buttons
- üé§ –ú–∏–∫—Ä–æ—Ñ–æ–Ω (—Å–∏–Ω–∏–π) - –Ω–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å
- ‚èπÔ∏è –°—Ç–æ–ø (–∫—Ä–∞—Å–Ω—ã–π) - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
- ‚¨ÜÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ

---

## üêõ Troubleshooting

### –û—à–∏–±–∫–∞: "Microphone access is required"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –¥–æ–±–∞–≤–∏–ª `NSMicrophoneUsageDescription` –≤ Info.plist

### –û—à–∏–±–∫–∞: "OpenAI API key not configured"
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—É `supabase secrets set OPENAI_API_KEY=...`

### –û—à–∏–±–∫–∞: "Whisper API error (401)"
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ OpenAI API –∫–ª—é—á –≤–∞–ª–∏–¥–Ω—ã–π –∏ –∏–º–µ–µ—Ç credits

### –ö–Ω–æ–ø–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Å—å —á—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—à—å –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, –∞ –Ω–µ –Ω–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ

### –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –ø—É—Å—Ç–∞—è –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
**–†–µ—à–µ–Ω–∏–µ:**
- –ì–æ–≤–æ—Ä–∏ –≥—Ä–æ–º—á–µ –∏ —á—ë—Ç—á–µ
- –£–±–µ–¥–∏—Å—å —á—Ç–æ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –º–∏–∫—Ä–æ—Ñ–æ–Ω —Ä—É–∫–æ–π/—á–µ—Ö–ª–æ–º
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω–µ —Å–ª–∏—à–∫–æ–º —à—É–º–Ω–æ–µ

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å

**OpenAI Whisper API Pricing:**
- $0.006 –∑–∞ –º–∏–Ω—É—Ç—É –∞—É–¥–∏–æ
- –ü—Ä–∏–º–µ—Ä: 100 –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ 30 —Å–µ–∫ = 50 –º–∏–Ω—É—Ç = **$0.30**

**–î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
- Claude API: ~$0.003 –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- Total –¥–ª—è —Ç–∏–ø–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: ~$5-10/–º–µ—Å—è—Ü

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –£–ª—É—á—à–µ–Ω–∏—è v2:
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ (–∞–≤—Ç–æ-–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–±–æ—Ä)
- [ ] –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã –∑–∞–ø–∏—Å–∏ (–±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏)
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—É–¥–∏–æ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
- [ ] Voice Activity Detection (–∞–≤—Ç–æ—Å—Ç–æ–ø –ø—Ä–∏ –º–æ–ª—á–∞–Ω–∏–∏)
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (chunking –¥–ª—è > 25MB —Ñ–∞–π–ª–æ–≤)

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ –≤—ã—à–µ, voice input –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—Ç—å!

**–ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫:**
- [ ] –î–æ–±–∞–≤–∏–ª `NSMicrophoneUsageDescription` –≤ Info.plist
- [ ] Deploy whisper-proxy Edge Function
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏–ª `OPENAI_API_KEY` —Å–µ–∫—Ä–µ—Ç
- [ ] –î–æ–±–∞–≤–∏–ª `SpeechRecognitionService.swift` –≤ Xcode –ø—Ä–æ–µ–∫—Ç
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚ú®
